!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).formCreator=t()}(this,function(){"use strict";function z(n){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},t=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.forEach(function(e){var t,r,o;t=n,o=i[r=e],r in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o})}return n}function T(e,t){if(null==e)return{};var r,o,n=function(e,t){if(null==e)return{};var r,o,n={},i=Object.keys(e);for(o=0;o<i.length;o++)r=i[o],0<=t.indexOf(r)||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)r=i[o],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],o=!0,n=!1,i=void 0;try{for(var l,a=e[Symbol.iterator]();!(o=(l=a.next()).done)&&(r.push(l.value),!t||r.length!==t);o=!0);}catch(e){n=!0,i=e}finally{try{o||null==a.return||a.return()}finally{if(n)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function J(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var l={name:"form-msg",props:{model:{type:[Object,Array],default:function(){}}},data:function(){return{showVal:!1}},render:function(e){var t=this;return e("div",[e("button",{style:{padding:"2px 4px",position:"fixed","z-index":100000002,top:"10px",right:"10px",cursor:"pointer",background:"#2d8cf0",color:"#fff"},on:{click:function(){return t.showVal=!t.showVal}}},[this.showVal?"关闭":"表单值"]),this.showVal&&e("div",{style:{position:"fixed","z-index":100000001,top:0,right:0,width:"300px",height:"300px",background:"rgb(236, 251, 240)","over-flow":"scroll",opacity:.6,padding:"20px",color:"rgb(0, 0, 0)"}},[e("pre",[JSON.stringify(this.model,null,2)])])])}},n={element:{Row:"el-row",Col:"el-col",Form:"el-form",FormItem:"el-form-item",Input:"el-input",Select:"el-select",Option:"el-option",RadioGroup:"el-radio-group",Radio:"el-radio",CheckboxGroup:"el-checkbox-group",Checkbox:"el-checkbox"},iview:{Row:"Row",Col:"i-col",Form:"Form",FormItem:"FormItem",Input:"Input",Select:"Select",Option:"Option",RadioGroup:"RadioGroup",Radio:"Radio",CheckboxGroup:"CheckboxGroup",Checkbox:"Checkbox"}},N=function(e){return e.replace(/\[(\w+)\]/g,".$1").replace(/^\./,"").split(".")};return{install:function e(t){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{ui:"element"};if(!e.installed){"string"==typeof r&&(r={ui:r});var $,o=($=n[r.ui],{name:"form-creator",props:{value:{type:Object,default:function(){return{}}},fields:{type:[Object,Array],default:function(){return[]}},option:{type:Object,default:function(){}},size:{type:String,default:"medium"}},data:function(){return{updating:!1,formValues:this.mergeValues()}},watch:{formValues:{handler:function(e){this.updating=!0,this.$emit("input",e)},deep:!0},model:{handler:function(e){this.updating?this.updating=!1:this.formValues=this.mergeValues()},deep:!0}},render:function(e){var t=this,r=t.option,o=r.status,n=r.debug,i=T(r,["status","debug"]);return e("div",{},[e($.Form,{props:z({model:t.formValues,disabled:"disabled"===o},i),ref:"form"},[].concat(J(t.$slots.prepend||[]),J(t.renderFormItems(e)||[]),J(t.$slots.append||[]))),n&&e(l,{props:{model:t.formValues}})])},created:function(){this.$emit("input",this.formValues)},methods:{getFormRef:function(){return this.$refs.form},mergeValues:function(){return this.value},filterAttrs:function(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=Object.keys(r),o={};return e.forEach(function(e){var t=r[e];"number"!=typeof t&&"string"!=typeof t&&"boolean"!=typeof t||(o[e]=t)}),o},renderFormItem:function(t,e){var r=e.tag,o=e.component,n=e.rules,i=e.previewFormItemValue,l=e.label,a=e.item,u=void 0===a?{}:a,s=e.class,p=void 0===s?{}:s,c=e.style,f=void 0===c?{}:c,m=T(e,["tag","component","rules","previewFormItemValue","label","item","class","style"]);if(r&&o)return console.error("tag 与 component不可同时使用"),null;var d=this,b=d.formValues,y=d.size,h=m.name,v=null,g=null;if(Object.prototype.hasOwnProperty.call(b,h))v=b[h];else{var w=D(N(h),3),O=w[0],x=w[1],A=w[2];v=b[O][x][A]}g=v;var j=z({input:function(e){if(Object.prototype.hasOwnProperty.call(b,h))b[h]=e;else{var t=D(N(h),3),r=t[0],o=t[1],n=t[2];b[r][o][n]=e}}},m.on||{}),k=[],I=(m.scopedSlots||[]).map(function(e){return e(t)});if(o)if(h){var V={class:p,style:f,attrs:z({},d.filterAttrs(m)),props:z({value:v},m),on:z({},j)};k=[t(o,V,I)]}else k=[o(t)];else k=r===$.Select?(m.multiple&&(g=""),m.options.forEach(function(e){m.multiple&&-1<v.indexOf(e.value)?g+="".concat(e.label,"、"):g===e.value&&(g=e.label)}),[t(r,{class:p,style:f,attrs:z({},d.filterAttrs(m)),props:z({value:v},m),on:z({},j)},(m.options||[]).map(function(e){return t($.Option,{attrs:z({},d.filterAttrs(e)),props:z({key:e.value},e)})}))]):r===$.CheckboxGroup?(m.options.forEach(function(e){g===e.value&&(g=e.label)}),[t($.CheckboxGroup,{class:p,style:f,attrs:z({},d.filterAttrs(m)),props:z({value:v},m),on:z({},j)},(m.options||[]).map(function(e){return t($.Checkbox,{attrs:z({},d.filterAttrs(e)),props:z({key:e.value,label:e.value},e)},[e.label])}))]):r===$.RadioGroup?[t($.RadioGroup,{class:p,style:f,attrs:z({},d.filterAttrs(m)),props:z({value:v},m),on:z({},j)},(m.options||[]).map(function(e){return t($.Radio,{attrs:z({},d.filterAttrs(e)),props:z({key:e.value,label:e.value},e),on:z({},j)},[e.label])}))]:[t(r||$.Input,{class:p,style:f,attrs:z({},d.filterAttrs(m)),props:z({value:v},m),on:z({},j)},I)];var S=u.style||{},F=u.class||{},R=(u.scopedSlots||[]).map(function(e){return e(t)}),C=[];"preview"===d.option.status?(C=g,i&&(C=i(v,t))):C=J(k);var G=u.label,P=T(u,["label"]),E=G||l||"";return t($.FormItem,{style:S,class:F,props:z({rules:n,size:y,label:E+(E&&d.option.autoAuffix?"：":""),prop:h},P)},[C].concat(J(R)))},renderFormItems:function(n){var o=this,i=function(e){var t,r=o.option.itemSpan||24;return t=e.name?o.renderFormItem(n,e):e.component(n),n($.Col,{props:{span:e.span||r}},[t])};return this.fields.map(function(e,t){if(Array.isArray(e)){var r=e.map(function(e){return i(e)});return n($.Row,{props:{gutter:e[0].gutter||40}},r)}var o=i(e);return n($.Row,[o])})}}});t.component(o.name,o)}}}});
