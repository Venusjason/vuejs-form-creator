!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).formCreator=t()}(this,function(){"use strict";function E(n){for(var e=1;e<arguments.length;e++){var l=null!=arguments[e]?arguments[e]:{},t=Object.keys(l);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(l).filter(function(e){return Object.getOwnPropertyDescriptor(l,e).enumerable}))),t.forEach(function(e){var t,r,o;t=n,o=l[r=e],r in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o})}return n}function $(e,t){if(null==e)return{};var r,o,n=function(e,t){if(null==e)return{};var r,o,n={},l=Object.keys(e);for(o=0;o<l.length;o++)r=l[o],0<=t.indexOf(r)||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)r=l[o],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],o=!0,n=!1,l=void 0;try{for(var i,a=e[Symbol.iterator]();!(o=(i=a.next()).done)&&(r.push(i.value),!t||r.length!==t);o=!0);}catch(e){n=!0,l=e}finally{try{o||null==a.return||a.return()}finally{if(n)throw l}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function T(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var n={element:{Row:"el-row",Col:"el-col",Form:"el-form",FormItem:"el-form-item",Input:"el-input",Select:"el-select",Option:"el-option",RadioGroup:"el-radio-group",Radio:"el-radio",CheckboxGroup:"el-checkbox-group",Checkbox:"el-checkbox"},iview:{Row:"Row",Col:"i-col",Form:"Form",FormItem:"FormItem",Input:"Input",Select:"Select",Option:"Option",RadioGroup:"RadioGroup",Radio:"Radio",CheckboxGroup:"CheckboxGroup",Checkbox:"Checkbox"}},D=function(e){return e.replace(/\[(\w+)\]/g,".$1").replace(/^\./,"").split(".")};return{install:function e(t){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{ui:"element"};if(!e.installed){"string"==typeof r&&(r={ui:r});var P,o=(P=n[r.ui],{name:"form-creator",props:{value:{type:Object,default:function(){return{}}},fields:{type:[Object,Array],default:function(){return[]}},option:{type:Object,default:function(){}},size:{type:String,default:"medium"}},data:function(){return{updating:!1,formValues:this.mergeValues()}},watch:{formValues:{handler:function(e){this.updating=!0,this.$emit("input",e)},deep:!0},model:{handler:function(e){this.updating?this.updating=!1:this.formValues=this.mergeValues()},deep:!0}},render:function(e){var t=this,r=t.option,o=r.status,n=(r.debug,$(r,["status","debug"]));return e("div",{},[e(P.Form,{props:E({model:t.formValues,disabled:"disabled"===o},n),ref:"form"},[].concat(T(t.$slots.prepend||[]),T(t.renderFormItems(e)||[]),T(t.$slots.append||[])))])},created:function(){this.$emit("input",this.formValues)},methods:{getFormRef:function(){return this.$refs.form},mergeValues:function(){return this.value},filterAttrs:function(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=Object.keys(r),o={};return e.forEach(function(e){var t=r[e];"number"!=typeof t&&"string"!=typeof t&&"boolean"!=typeof t||(o[e]=t)}),o},renderFormItem:function(t,e){var r=e.tag,o=e.component,n=e.rules,l=e.previewFormItemValue,i=e.item,a=void 0===i?{}:i,u=e.class,s=void 0===u?{}:u,p=e.style,c=void 0===p?{}:p,f=$(e,["tag","component","rules","previewFormItemValue","item","class","style"]);if(r&&o)return console.error("tag 与 component不可同时使用"),null;var m=this,d=m.formValues,y=m.size,b=f.name,v=null,h=null;if(Object.prototype.hasOwnProperty.call(d,b))v=d[b];else{var g=z(D(b),3),O=g[0],w=g[1],A=g[2];v=d[O][w][A]}h=v;var j=E({input:function(e){if(Object.prototype.hasOwnProperty.call(d,b))d[b]=e;else{var t=z(D(b),3),r=t[0],o=t[1],n=t[2];d[r][o][n]=e}}},f.on||{}),x=[],k=(f.scopedSlots||[]).map(function(e){return e(t)});if(o)if(b){var I={class:s,style:c,attrs:E({},m.filterAttrs(f)),props:E({value:v},f),on:E({},j)};x=[t(o,I,k)]}else x=[o(t)];else x=r===P.Select?(f.multiple&&(h=""),f.options.forEach(function(e){f.multiple&&-1<v.indexOf(e.value)?h+="".concat(e.label,"、"):h===e.value&&(h=e.label)}),[t(r,{class:s,style:c,attrs:E({},m.filterAttrs(f)),props:E({value:v},f),on:E({},j)},(f.options||[]).map(function(e){return t(P.Option,{attrs:E({},m.filterAttrs(e)),props:E({key:e.value},e)})}))]):r===P.CheckboxGroup?(f.options.forEach(function(e){h===e.value&&(h=e.label)}),[t(P.CheckboxGroup,{class:s,style:c,attrs:E({},m.filterAttrs(f)),props:E({value:v},f),on:E({},j)},(f.options||[]).map(function(e){return t(P.Checkbox,{attrs:E({},m.filterAttrs(e)),props:E({key:e.value,label:e.value},e)},[e.label])}))]):r===P.RadioGroup?[t(P.RadioGroup,{class:s,style:c,attrs:E({},m.filterAttrs(f)),props:E({value:v},f),on:E({},j)},(f.options||[]).map(function(e){return t(P.Radio,{attrs:E({},m.filterAttrs(e)),props:E({key:e.value,label:e.value},e),on:E({},j)},[e.label])}))]:[t(r||P.Input,{class:s,style:c,attrs:E({},m.filterAttrs(f)),props:E({value:v},f),on:E({},j)},k)];var F=a.style||{},R=a.class||{},S=(a.scopedSlots||[]).map(function(e){return e(t)}),C=[];"preview"===m.option.status?(C=h,l&&(C=l(v,t))):C=T(x);var V=a.label,G=$(a,["label"]);return t(P.FormItem,{style:F,class:R,props:E({rules:n,size:y,label:V+(m.option.autoAuffix?"：":""),prop:b},G)},[C].concat(T(S)))},renderFormItems:function(n){var r=this,l=function(e){var t;return t=e.name?r.renderFormItem(n,e):e.component(n),n(P.Col,{props:{span:e.span||24}},[t])};return this.fields.map(function(e,t){if(Array.isArray(e)){var r=e.map(function(e){return l(e)});return n(P.Row,{props:{gutter:e[0].gutter||40}},r)}var o=l(e);return n(P.Row,[o])})}}});t.component(o.name,o)}}}});
